!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Aimbrain=t():e.Aimbrain=t()}(this,function(){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={exports:{},id:i,loaded:!1};return e[i].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="/",t(0)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1);t.api=i.api;var r=n(11);t.session=r.session;var o=n(15);t.behaviour=o.behaviour;var a=n(21);t.voice=a.voice;var s=n(36);t.facial=s.facial},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,r=n(2);!function(e){function t(e){r.setBaseUrl(e)}function n(e,t){r.setApiCredentials(e,t)}function i(e,t,n,i,o,a){var s={userId:e,device:t,system:n,screenHeight:i,screenWidth:o};return a&&(s.metadata=a),r.createRequest({method:"post",uri:"/v1/sessions",body:s})}function o(e,t,n,i){var o={session:e,mouseEvents:t,keyUpDownEvents:n};return i&&(o.metadata=i),r.createRequest({method:"post",uri:"/v1/behavioural",body:o})}function a(e,t,n){var i={session:e,tokentype:t};return n&&(i.metadata=n),r.createRequest({method:"post",uri:"/v1/voice/token",body:i})}function s(e,t,n){var i={session:e,voices:t};return n&&(i.metadata=n),r.createRequest({method:"post",uri:"/v1/voice/enroll",body:i})}function c(e,t,n){var i={session:e,voices:t};return n&&(i.metadata=n),r.createRequest({method:"post",uri:"/v1/voice/auth",body:i})}function u(e,t,n){var i={session:e,faces:t};return n&&(i.metadata=n),r.createRequest({method:"post",uri:"/v1/face/enroll",body:i})}function l(e,t,n){var i={session:e,faces:t};return n&&(i.metadata=n),r.createRequest({method:"post",uri:"/v1/face/auth",body:i})}var d;!function(e){e[e.NotEnrolled=0]="NotEnrolled",e[e.Enrolled=1]="Enrolled",e[e.Building=2]="Building"}(d=e.EnrollmentStatus||(e.EnrollmentStatus={}));var f;!function(e){e[e.UnrecognizedResponse=1]="UnrecognizedResponse",e[e.NoOpenSession=2]="NoOpenSession",e[e.RequestError=3]="RequestError",e[e.BadRequest=400]="BadRequest",e[e.InvalidKeyOrSignature=401]="InvalidKeyOrSignature",e[e.InvalidSessionId=403]="InvalidSessionId",e[e.AuthorizationFailed=422]="AuthorizationFailed",e[e.EnrollmentFailed=422]="EnrollmentFailed",e[e.NotEnrolledYet=424]="NotEnrolledYet",e[e.ServerError=500]="ServerError"}(f=e.ErrorCode||(e.ErrorCode={})),e.setBaseUrl=t,e.setKeyAndSecret=n,e.createSession=i,e.sendEvents=o,e.getVoiceChallenge=a,e.enrollVoice=s,e.authenticateVoice=c,e.enrollFace=u,e.authenticateFace=l}(i=t.api||(t.api={}))},function(e,t,n){"use strict";function i(e){var n=[e.method.toUpperCase(),e.uri.toLowerCase(),JSON.stringify(e.body)].join("\n"),i=u.encode(c.hmacSha256(t.apiSecret,n,!0));return e.headers["X-aimbrain-apikey"]=t.apiKey,e.headers["X-aimbrain-signature"]=i,e}function r(e){t.baseUrl=e}function o(e,n){t.apiKey=e,t.apiSecret=n}function a(e){e.baseUrl=t.baseUrl;var n=new s.Request(e);return n.headers["Content-Type"]="application/json",null!=t.apiKey&&null!=t.apiSecret&&i(n),n}Object.defineProperty(t,"__esModule",{value:!0});var s=n(3),c=n(7),u=n(10);t.setBaseUrl=r,t.setApiCredentials=o,t.createRequest=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(4),r=n(6),o=1,a=3,s=function(){function e(e){this.middleware=[],e&&r.defaults(this,e),this.headers=this.headers||{},this.uri=this.uri||""}return e.prototype.then=function(e,t){return this.send().then(e,t)},e.prototype.use=function(e,t){return this.middleware.push({onResolve:e,onReject:t}),this},e.prototype.send=function(){var e=this;if(this.promise)return this.promise;var t=new XMLHttpRequest;t.open(this.method,this.baseUrl+this.uri);for(var n in this.headers)this.headers.hasOwnProperty(n)&&t.setRequestHeader(n,this.headers[n]);return this.promise=new i.Promise(function(n,i){if(t.addEventListener("load",function(){var e;try{e=JSON.parse(t.responseText),200!==t.status&&(e.errorCode=t.status)}catch(n){e={error:t.response,errorCode:o}}return 200!==t.status?i(e):n(e)}),t.addEventListener("error",function(e){i({errorCode:a,error:e})}),e.body){var r=JSON.stringify(e.body);try{return t.send(r)}catch(e){i({errorCode:a,error:e})}}try{return t.send()}catch(e){i({errorCode:a,error:e})}}),this.middleware.forEach(function(t){var n=t.onResolve,i=t.onReject;e.promise=e.promise.then(n,i)}),this.promise},e.prototype.serialize=function(){return JSON.stringify(this.body)},e}();t.Request=s},function(e,t,n){"use strict";function i(){return t.Promise}function r(e){t.Promise=e}Object.defineProperty(t,"__esModule",{value:!0});var o=n(5);o.global&&o.global.Promise&&(t.Promise=o.global.Promise),t.getPromiseContructor=i,t.setPromiseContructor=r},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.global=Function("return this")()||{}},function(e,t){"use strict";function n(e,t){var n=Object(e);for(var i in t)t.hasOwnProperty(i)&&!n.hasOwnProperty(i)&&(n[i]=t[i]);return n}Object.defineProperty(t,"__esModule",{value:!0}),t.defaults=n},function(e,t,n){"use strict";function i(e,t,n,i){var r=e/8|0;if(n.length<r)for(var o=n.length;o&r;o++)n.push(0);else n.length>r&&(n=t(n));for(var a=[],o=0;o<r;o++)a.push(92^n[o]);for(var s=[],o=0;o<r;o++)s.push(54^n[o]);return t(a.concat(t(s.concat(i))))}function r(e,t,n){void 0===n&&(n=!1),"string"==typeof e&&(e=a.stringToUint8Array(e)),"string"==typeof t&&(t=a.stringToUint8Array(t));var r=i(512,function(e){return o.default(e,!0)},e,t);return n?r:a.uint8ArrayToHex(r)}Object.defineProperty(t,"__esModule",{value:!0});var o=n(8),a=n(9);t.hmac=i,t.hmacSha256=r},function(e,t,n){"use strict";function i(e,t){for(var n,i,r,o=e.slice(0),a=t[0],c=t[1],u=t[2],l=t[3],d=t[4],f=t[5],g=t[6],v=t[7],p=0;p<64;p++)p<16?n=o[p]:(i=o[p+1&15],r=o[p+14&15],n=o[15&p]=(i>>>7^i>>>18^i>>>3^i<<25^i<<14)+(r>>>17^r>>>19^r>>>10^r<<15^r<<13)+o[15&p]+o[p+9&15]|0),n+=v+(d>>>6^d>>>11^d>>>25^d<<26^d<<21^d<<7)+(g^d&(f^g))+s[p],v=g,g=f,f=d,d=l+n|0,l=u,u=c,c=a,a=n+(c&u^l&(c^u))+(c>>>2^c>>>13^c>>>22^c<<30^c<<19^c<<10)|0;return t[0]=t[0]+a|0,t[1]=t[1]+c|0,t[2]=t[2]+u|0,t[3]=t[3]+l|0,t[4]=t[4]+d|0,t[5]=t[5]+f|0,t[6]=t[6]+g|0,t[7]=t[7]+v|0,t}function r(e,t){void 0===t&&(t=!1);var n=e;"string"==typeof e&&(n=o.stringToUint8Array(e));var r=n.length;n.push(128);for(var s=o.uint8ArrayToUint32Array(n),c=s.length+2;15&c;c++)s.push(0);s.push(r/4294967296|0),s.push(8*r|0);for(var u=a.slice(0),c=0;c<s.length;c+=16)u=i(s.slice(c,c+16),u);return t?o.uint32ArrayToUint8Array(u):o.uint32ArrayToHex(u)}Object.defineProperty(t,"__esModule",{value:!0});var o=n(9),a=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],s=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];t.default=r},function(e,t){"use strict";function n(e){return u(i(e))}function i(e){for(var t=[],n=0;n<e.length;n++)t.push(e.charCodeAt(n));return t}function r(e){return l(i(e))}function o(e){return c(a(e))}function a(e){for(var t=[],n=0;n<e.length;n+=2)t.push(parseInt(e.substr(n,2),16));return t}function s(e){return l(a(e))}function c(e){return e.map(function(e){return String.fromCharCode(e)}).join("")}function u(e){for(var t="",n=0;n<e.length;n++)t+=(e[n]<16?"0":"")+e[n].toString(16);return t}function l(e){var t=[],n=e.length,i=0,r=0;for(r=0;r<n||0!==(3&r);r++)i<<=8,r<n&&(i|=e[r]),3===(3&r)&&(t.push(i),i=0);return t}function d(e,t){return c(g(e,t))}function f(e,t){return u(g(e,t))}function g(e,t){for(var n=[],i=e.length,r=0;r<i;r++)for(var o=e[r],a=3;a>=0;a--)n.push(o>>8*a&255);return t?n.slice(0,t):n}Object.defineProperty(t,"__esModule",{value:!0}),t.stringToHex=n,t.stringToUint8Array=i,t.stringToUint32Array=r,t.hexToString=o,t.hexToUint8Array=a,t.hexToUint32Array=s,t.uint8ArrayToString=c,t.uint8ArrayToHex=u,t.uint8ArrayToUint32Array=l,t.uint32ArrayToString=d,t.uint32ArrayToHex=f,t.uint32ArrayToUint8Array=g},function(e,t,n){"use strict";function i(e){"string"==typeof e&&(e=o.stringToUint8Array(e));for(var t="",n=0;n<e.length;){var i=e[n++],r=e[n++],s=e[n++],c=i>>2,u=(3&i)<<4|r>>4,l=(15&r)<<2|s>>6,d=63&s;isNaN(r)?l=d=64:isNaN(s)&&(d=64),t+=a.charAt(c)+a.charAt(u)+a.charAt(l)+a.charAt(d)}return t}function r(e,t){void 0===t&&(t=!1);var n=[];e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var i=0;i<e.length;){var r=a.indexOf(e.charAt(i++)),s=a.indexOf(e.charAt(i++)),c=a.indexOf(e.charAt(i++)),u=a.indexOf(e.charAt(i++)),l=r<<2|s>>4,d=(15&s)<<4|c>>2,f=(3&c)<<6|u;n.push(l),64!==c&&n.push(d),64!==u&&n.push(f)}return t?n:o.uint8ArrayToString(n)}Object.defineProperty(t,"__esModule",{value:!0});var o=n(9),a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";t.encode=i,t.decode=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,r=n(1),o=n(12),a=n(13);!function(e){function t(e,t,n){return a.createSession(e,t,n)}function n(e,t){return o.setCachedSession(new o.Session(e,t,r.api.EnrollmentStatus.Enrolled,r.api.EnrollmentStatus.Enrolled,r.api.EnrollmentStatus.Enrolled))}function i(){o.clearCache()}function s(){return null!=o.getCachedSession()}function c(){return o.getCachedSession()?o.getCachedSession().getId():null}function u(){var e=o.getCachedSession();return null!=e&&e.isBehaviouralEnrolled()}function l(){var e=o.getCachedSession();return null!=e&&e.isBehaviouralBuilding()}function d(){var e=o.getCachedSession();return null!=e&&e.isFacialEnrolled()}function f(){var e=o.getCachedSession();return null!=e&&e.isFacialBuilding()}function g(){var e=o.getCachedSession();return null!=e&&e.isVoiceEnrolled()}function v(){var e=o.getCachedSession();return null!=e&&e.isVoiceBuilding()}e.establishSession=t,e.setExistingSession=n,e.clearSession=i,e.isSessionActive=s,e.getSessionId=c,e.isBehaviouralEnrolled=u,e.isBehaviouralBuilding=l,e.isFacialEnrolled=d,e.isFacialBuilding=f,e.isVoiceEnrolled=g,e.isVoiceBuilding=v}(i=t.session||(t.session={}))},function(e,t,n){"use strict";function i(){if(f)return f;var e;return e=p.getItem(v),e?f=parseFloat(e):null}function r(e){f=e,p.setItem(v,e.toString())}function o(){if(d)return d;var e;if(p&&(e=p.getItem(g)),e){var t=JSON.parse(e),n=t.userId,i=t.sessionId,r=t.behaviour,o=t.face,a=t.voice;return d=new l(n,i,r,o,a)}return null}function a(e){if(d=e,p){var t=JSON.stringify({userId:e.userId,sessionId:e.session,face:e.face,voice:e.voice,behaviour:e.behaviour});p.setItem(g,t)}}function s(){d=null,f=null,p&&(p.removeItem(g),p.removeItem(v))}Object.defineProperty(t,"__esModule",{value:!0});var c=n(5),u=n(1),l=function(){function e(e,t,n,i,r){this.userId=e,this.session=t,this.behaviour=n,this.face=i,this.voice=r}return e.prototype.getId=function(){return this.session},e.prototype.isBehaviouralEnrolled=function(){return this.behaviour===u.api.EnrollmentStatus.Enrolled},e.prototype.isBehaviouralBuilding=function(){return this.behaviour===u.api.EnrollmentStatus.Building},e.prototype.isFacialEnrolled=function(){return this.face===u.api.EnrollmentStatus.Enrolled},e.prototype.isFacialBuilding=function(){return this.face===u.api.EnrollmentStatus.Building},e.prototype.isVoiceEnrolled=function(){return this.voice===u.api.EnrollmentStatus.Enrolled},e.prototype.isVoiceBuilding=function(){return this.voice===u.api.EnrollmentStatus.Building},e}();t.Session=l;var d,f,g="aimbrain_session",v="aimbrain_score",p=c.global.sessionStorage;t.getCachedSessionScore=i,t.setCachedSessionScore=r,t.getCachedSession=o,t.setCachedSession=a,t.clearCache=s},function(e,t,n){"use strict";function i(e,t,n){var i=s.api.createSession(e,o.browserName,o.browserOS,o.screenHeight,o.screenWidth,t);return n?a.Promise.resolve(i.serialize()):i.then(function(t){var n=new c.Session(e,t.session,t.behaviour,t.face,t.voice);return c.setCachedSession(n),t})}function r(e,t){var n=c.getCachedSession();return n&&n.userId===e?a.Promise.resolve(n):i(e,t,!1)}Object.defineProperty(t,"__esModule",{value:!0});var o=n(14),a=n(4),s=n(1),c=n(12);t.createSession=i,t.ensureSessionCreated=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(5);t.browserName="Other";var r=!!i.global.opr&&!!i.global.opr.addons||!!i.global.opera||navigator.userAgent.indexOf(" OPR/")>=0,o="undefined"!=typeof i.global.InstallTrigger,a=(Object.prototype.toString.call(i.global.HTMLElement).indexOf("Constructor")>0,!!i.global.document.documentMode),s=!a&&!!i.global.StyleMedia,c=!!i.global.chrome&&!!i.global.chrome.webstore;r?t.browserName="Opera":o?t.browserName="Firefox":s?t.browserName="Edge":a?t.browserName="isIE":c&&(t.browserName="Chrome"),t.browserOS=null;var u=navigator.appVersion;u.indexOf("Win")>=0?t.browserOS="Windows":u.indexOf("Mac")>=0?u.indexOf("iP")>=0?t.browserOS="iOS":t.browserOS="macOS":u.indexOf("Android")>=0?t.browserOS="Android":u.indexOf("Linux")>=0?t.browserOS="Linux":u.indexOf("X11")>=0&&(t.browserOS="Unix-like"),t.screenWidth=null,t.screenHeight=null,i.global.screen&&(t.screenWidth=i.global.screen.availHeight,t.screenHeight=i.global.screen.availWidth)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,r=n(12),o=n(16),a=n(17),s=n(18),c=n(20);!function(e){function t(){return a.isSupported()}function n(e,t){o.setElementSdkId(e,t)}function i(e){o.setIgnored(e instanceof HTMLElement?[e]:e)}function u(e){o.unsetIgnored(e instanceof HTMLElement?[e]:e)}function l(e){o.setSensitiveSalt(e)}function d(e){o.setSensitive(e instanceof HTMLElement?[e]:e)}function f(e){o.unsetSensitive(e instanceof HTMLElement?[e]:e)}function g(e,t){return s.sendCollectedEvents(e,t)}function v(){return a.clearStoredEvents()}function p(){c.startTracking()}function m(){c.stopTracking()}function h(){return r.getCachedSessionScore()}function b(e){s.startBackgroundSending(e)}function M(){s.stopBackgroundSending()}function I(e){p(),b(e)}e.isSupported=t,e.setAimbrainId=n,e.addToUntrackableList=i,e.removeFromUntrackableList=u,e.setSensitiveSalt=l,e.addToSensitiveList=d,e.removeFromSensitiveList=f,e.sendCollectedEvents=g,e.clearCollectedEvents=v,e.startTracking=p,e.stopTracking=m,e.getScore=h,e.startSending=b,e.stopSending=M,e.start=I}(i=t.behaviour||(t.behaviour={}))},function(e,t,n){"use strict";function i(e){t.sensitiveSalt=e}function r(e){var n=e.getAttribute(p);return n||(n=e.id),n&&s(e)&&(n=g.default(n+v.hexToString(t.sensitiveSalt))),n?n:null}function o(e){for(var n=[],i=s(e);null!=e;){var r=e.getAttribute(p);r||(r=e.id),r&&i&&(r=g.default(r+v.hexToString(t.sensitiveSalt))),r&&n.push(r),e=e.parentElement}return n}function a(e,t){t.setAttribute(p,e)}function s(e){return"true"===e.getAttribute(m)||!!e.parentElement&&s(e.parentElement)}function c(e){for(var t=0,n=e;t<n.length;t++){var i=n[t];i&&i.setAttribute(m,"true")}}function u(e){for(var t=0,n=e;t<n.length;t++){var i=n[t];i&&i.removeAttribute(m)}}function l(e){return"true"===e.getAttribute(h)||!!e.parentElement&&l(e.parentElement)}function d(e){for(var t=0,n=e;t<n.length;t++){var i=n[t];i&&i.setAttribute(h,"true")}}function f(e){for(var t=0,n=e;t<n.length;t++){var i=n[t];i&&i.removeAttribute(h)}}Object.defineProperty(t,"__esModule",{value:!0});var g=n(8),v=n(9),p="data-aimbrain-id",m="data-aimbrain-sensitive",h="data-aimbrain-ignored";t.sensitiveSalt="",t.setSensitiveSalt=i,t.getElementSdkId=r,t.getElementIdChain=o,t.setElementSdkId=a,t.isSensitive=s,t.setSensitive=c,t.unsetSensitive=u,t.isIgnored=l,t.setIgnored=d,t.unsetIgnored=f},function(e,t,n){"use strict";function i(){return null!=r()}function r(){return v.global.indexedDB}function o(){h&&h.close(),h=null,r().deleteDatabase(I)}function a(){return h?p.Promise.resolve(h):new p.Promise(function(e,t){function n(e){var t=e.createObjectStore(b,{autoIncrement:!0});t.createIndex("by_timestamp","t");var n=e.createObjectStore(M,{autoIncrement:!0});n.createIndex("by_timestamp","t")}var i=r().open(I,y);i.onsuccess=function(t){h=this.result,h.onversionchange=function(e){h&&h.close(),h=null},e(h)},i.onerror=function(e){t(e)},i.onupgradeneeded=function(e){for(var t=e.currentTarget,i=t.result,r=e.oldVersion;r<=e.newVersion;r++)0==r&&n(i)}})}function s(e){return u(b,e)}function c(e){return u(M,e)}function u(e,t){return a().then(function(n){return new p.Promise(function(i,r){var o=n.transaction(e,"readwrite");o.oncomplete=function(e){i()},o.onerror=function(e){r(event)},o.objectStore(e).add(t)})})}function l(e,t){return a().then(function(n){return new p.Promise(function(i,r){function o(e,t,n){var i=a.objectStore(e),r=i.index("by_timestamp"),o=r.openKeyCursor(IDBKeyRange.bound(t,n,!1,!1));o.addEventListener("success",function(e){var t=e.target.result;t&&(i.delete(t.primaryKey),t.continue())})}var a=n.transaction([b,M],"readwrite");if(a.oncomplete=function(e){i()},a.onerror=function(e){r(event)},e.length>0){var s=e[0].t,c=e[e.length-1].t;o(b,s,c)}if(t.length>0){var s=t[0].t,c=t[t.length-1].t;o(M,s,c)}})})}function d(){return a().then(function(e){function t(e){return new p.Promise(function(t,i){var r=n.objectStore(e).openCursor(),o=[];r.addEventListener("success",function(e){var n=e.target.result;n?(o.push(n.value),n.continue()):t(o)}),r.addEventListener("error",function(e){i(e)})})}var n=e.transaction([b,M],"readonly");return p.Promise.all([t(b),t(M)])})}function f(){return a().then(function(e){return new p.Promise(function(t,n){var i=e.transaction([b,M],"readwrite");i.oncomplete=function(e){t()},i.onerror=function(e){n(event)},i.objectStore(b).clear(),i.objectStore(M).clear()})})}Object.defineProperty(t,"__esModule",{value:!0});var g,v=n(5),p=n(4);!function(e){e[e.UP=0]="UP",e[e.DOWN=1]="DOWN",e[e.MOVE=2]="MOVE"}(g=t.MouseEventType||(t.MouseEventType={}));var m;!function(e){e[e.UP=0]="UP",e[e.DOWN=1]="DOWN"}(m=t.KeyDirection||(t.KeyDirection={}));var h,b="mouseEvents",M="keyEvents",I="aimbrain-sdk",y=1;t.isSupported=i,t.getDBFactory=r,t.dropSdkDB=o,t.getSdkDB=a,t.addMouseEvent=s,t.addKeyEvent=c,t.removeStoredEvents=l,t.getStoredEvents=d,t.clearStoredEvents=f},function(e,t,n){"use strict";function i(e,t){return t?a.getStoredEvents().then(function(n){var i=n[0],r=n[1];return c.sendEvents(i,r,e,t)}):a.getStoredEvents().then(function(t){var n=t[0];n.length>0;var i=t[1];return i.length>0,c.sendEvents(n,i,e,!1).then(function(e){return s.setCachedSessionScore(e.score),a.removeStoredEvents(n,i),e})})}function r(e){void 0===e&&(e=t.defaultSendingInterval),l||(l=!0,u=setInterval(function(){i(null,!1)},e))}function o(){l=!1,u&&(clearInterval(u),u=null)}Object.defineProperty(t,"__esModule",{value:!0});var a=n(17),s=n(12),c=n(19);t.defaultSendingInterval=3e3;var u,l=!1;t.sendCollectedEvents=i,t.startBackgroundSending=r,t.stopBackgroundSending=o},function(e,t,n){"use strict";function i(e,t,n,i){var s=a.getCachedSession();return null==s?r.Promise.reject({errorCode:o.api.ErrorCode.NoOpenSession,error:"This call requires active session"}):i?r.Promise.resolve(o.api.sendEvents(s.getId(),e,t,n).serialize()):o.api.sendEvents(s.getId(),e,t,n).send()}Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),o=n(1),a=n(12);t.sendEvents=i},function(e,t,n){"use strict";function i(e){var t=e.target;if(!f.isIgnored(t)){var n=f.isSensitive(t),i={docx:n?0:e.pageX,docy:n?0:e.pageY,elx:e.offsetX,ely:e.offsetY,btn:e.button,t:Date.now(),type:g.MouseEventType.DOWN,ids:f.getElementIdChain(t)};g.addMouseEvent(i)}}function r(e){var t=e.target;if(!f.isIgnored(t)){var n=f.isSensitive(t),i={docx:n?0:e.pageX,docy:n?0:e.pageY,elx:e.offsetX,ely:e.offsetY,btn:e.button,t:Date.now(),type:g.MouseEventType.UP,ids:f.getElementIdChain(t)};g.addMouseEvent(i)}}function o(e){var t=e.target;if(!f.isIgnored(t)){var n=Date.now();if(p++,!(n-m<v)){var i=f.isSensitive(t),r={docx:i?0:e.pageX,docy:i?0:e.pageY,elx:e.offsetX,ely:e.offsetY,t:n,no:p,type:g.MouseEventType.MOVE,ids:f.getElementIdChain(t)};m=n,p=0,g.addMouseEvent(r)}}}function a(e){var t=e.target;if(!f.isIgnored(t)){var n={t:Date.now(),key:e.key,dir:g.KeyDirection.UP,ids:f.getElementIdChain(t)};g.addKeyEvent(n)}}function s(e){var t=e.target;if(!f.isIgnored(t)){var n={t:Date.now(),key:e.key,dir:g.KeyDirection.DOWN,ids:f.getElementIdChain(t)};g.addKeyEvent(n)}}function c(){window.removeEventListener("mouseup",r),window.removeEventListener("mousedown",i),window.removeEventListener("mousemove",o),window.removeEventListener("keyup",a),window.removeEventListener("keydown",s)}function u(){window.addEventListener("mouseup",r),window.addEventListener("mousedown",i),window.addEventListener("mousemove",o),window.addEventListener("keyup",a),window.addEventListener("keydown",s)}function l(){t.isTracking||(u(),t.isTracking=!0)}function d(){t.isTracking&&(c(),t.isTracking=!1)}Object.defineProperty(t,"__esModule",{value:!0});var f=n(16),g=n(17),v=100,p=0,m=0;t.isTracking=!1,t.startTracking=l,t.stopTracking=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,r=n(22),o=n(23),a=n(25);!function(e){function t(){return o.isSupported()}function n(){return["enroll-1","enroll-2","enroll-3","enroll-4","enroll-5"]}function i(e,t,n){return r.getEnrollmentChallengeText(e,t,n)}function s(e,t){return r.getAuthenticationChallengeText(e,t)}function c(e,t,n){return r.enrollWithData(e,t,n)}function u(e,t,n){return r.authenticateWithData(e,t,n)}function l(e,t){return a.recordVoice(e,t)}e.isSupported=t,e.getEnrollmentTokenKeys=n,e.getEnrollmentToken=i,e.getAuthenticationToken=s,e.enrollWithData=c,e.authenticateWithData=u;var d;!function(e){e[e.PopupClosed=0]="PopupClosed",e[e.NotSupported=-1]="NotSupported",e[e.NoDevice=-2]="NoDevice",e[e.RecordingError=-3]="RecordingError"}(d=e.RecordingError||(e.RecordingError={})),e.recordVoice=l}(i=t.voice||(t.voice={}))},function(e,t,n){"use strict";function i(e,t,n){var i=u.getCachedSession();return null==i?s.Promise.reject({errorCode:c.api.ErrorCode.NoOpenSession,error:"This call requires active session"}):n?s.Promise.resolve(c.api.enrollVoice(i.getId(),e,t).serialize()):c.api.enrollVoice(i.getId(),e,t).send()}function r(e,t,n){var i=u.getCachedSession();return null==i?s.Promise.reject({errorCode:c.api.ErrorCode.NoOpenSession,error:"This call requires active session"}):n?s.Promise.resolve(c.api.authenticateVoice(i.getId(),e,t).serialize()):c.api.authenticateVoice(i.session,e,t).send().then(function(e){return u.setCachedSessionScore(e.score),e})}function o(e,t,n){var i=u.getCachedSession();return null==i?s.Promise.reject({errorCode:c.api.ErrorCode.NoOpenSession,error:"This call requires active session"}):n?s.Promise.resolve(c.api.getVoiceChallenge(i.getId(),e,t).serialize()):c.api.getVoiceChallenge(i.getId(),e,t).send().then(function(e){return s.Promise.resolve(e.token)})}function a(e,t){var n=u.getCachedSession();return null==n?s.Promise.reject({errorCode:c.api.ErrorCode.NoOpenSession,error:"This call requires active session"}):t?s.Promise.resolve(c.api.getVoiceChallenge(n.getId(),"auth",e).serialize()):c.api.getVoiceChallenge(n.getId(),"auth",e).send().then(function(e){return s.Promise.resolve(e.token)})}Object.defineProperty(t,"__esModule",{value:!0});var s=n(4),c=n(1),u=n(12);t.enrollWithData=i,t.authenticateWithData=r,t.getEnrollmentChallengeText=o,t.getAuthenticationChallengeText=a},function(e,t,n){"use strict";function i(e,t,n){n(new MediaStreamError)}function r(){return!(!f||!d)}function o(){if(!r()){var e=new Error("Audio capture is not supported on this platform");return c.Promise.reject(e)}return new c.Promise(function(e,t){f(v,function(t){e(t)},t)})}function a(e,t){return new c.Promise(function(n,i){null==g&&(g=new d);var r=g.createMediaStreamSource(e),o=g.createGain(),a=g.createScriptProcessor||g.createJavaScriptNode,s=a.call(g,2048,1,1);r.connect(o),o.connect(s),s.connect(g.destination);var c=[],u=function(e){for(var t=e.inputBuffer.getChannelData(0),n=0;n<t.length;n++)c.push(t[n])};s.addEventListener("audioprocess",u),p=function(){e.getAudioTracks()[0].stop(),s.removeEventListener("audioprocess",u),s.disconnect(g.destination),o.disconnect(s),r.disconnect(o),g.close&&(g.close(),g=null)},m=setTimeout(function(){var e=l.encodeWAV(c,g.sampleRate,1);p(),p=null,m=null,n(e)},t)})}function s(){try{m&&(clearTimeout(m),m=null),p&&(p(),p=null)}catch(e){}}Object.defineProperty(t,"__esModule",{value:!0});var c=n(4),u=n(5),l=n(24),d=u.global.AudioContext||u.global.webkitAudioContext,f=(navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||i).bind(navigator);t.isSupported=r;var g,v={video:!1,audio:{optional:[],mandatory:{googEchoCancellation:!1,googAutoGainControl:!1,googNoiseSuppression:!1,googHighpassFilter:!1}}};t.initAudio=o;var p,m;t.recordSample=a,t.stopRecording=s},function(e,t){"use strict";function n(e,t,n){for(var i=0;i<n.length;i++,t+=2){var r=Math.max(-1,Math.min(1,n[i]));e.setInt16(t,r<0?32768*r:32767*r,!0)}}function i(e,t,n){for(var i=0;i<n.length;i++)e.setUint8(t+i,n.charCodeAt(i))}function r(e,t,r){var o=new ArrayBuffer(44+2*e.length),a=new DataView(o);return i(a,0,"RIFF"),a.setUint32(4,36+2*e.length,!0),i(a,8,"WAVE"),i(a,12,"fmt "),a.setUint32(16,16,!0),a.setUint16(20,1,!0),a.setUint16(22,r,!0),a.setUint32(24,t,!0),a.setUint32(28,4*t,!0),a.setUint16(32,2*r,!0),a.setUint16(34,16,!0),i(a,36,"data"),a.setUint32(40,2*e.length,!0),n(a,44,e),new Blob([a],{type:"audio/wav"})}Object.defineProperty(t,"__esModule",{value:!0}),t.encodeWAV=r},function(e,t,n){"use strict";function i(e,n){return u.isSupported()?new Promise(function(i,c){l.open(function(e){switch(e){case l.DialogEvent.CloseClicked:s(),c(d.voice.RecordingError.PopupClosed);break;case l.DialogEvent.RecordClicked:u.isSupported()?u.initAudio().then(function(e){g=Date.now(),o(),r(e,t.recordingDuration).then(function(e){a(),l.close(),i(e)},function(e){u.stopRecording(),c(d.voice.RecordingError.RecordingError)})}).catch(function(e){s(),c(d.voice.RecordingError.NoDevice)}):(u.stopRecording(),c(d.voice.RecordingError.NotSupported));break;case l.DialogEvent.StopClicked:s(),c(d.voice.RecordingError.PopupClosed)}},e,n)}):Promise.reject(d.voice.RecordingError.NotSupported)}function r(e,t){return u.recordSample(e,t).then(function(e){return c.blobToBase64(e)}).then(function(e){return Promise.resolve([e])})}function o(){l.showProgress(Math.round(t.recordingDuration/1e3).toString()),f=setInterval(function(){var e=Date.now();if(0!==g&&g+t.recordingDuration>=e){var n=Math.round((t.recordingDuration-(e-g))/1e3);l.showProgress(n.toString())}g+t.recordingDuration<e&&f&&(l.showProgress("0"),clearInterval(f))},1e3)}function a(){f&&(clearInterval(f),f=null)}function s(){u.stopRecording(),a(),l.close()}Object.defineProperty(t,"__esModule",{value:!0});var c=n(26),u=n(23),l=n(27),d=n(21);t.recordingDuration=5e3;var f,g=0;t.recordVoice=i,t.cancelRecording=s},function(e,t,n){"use strict";function i(e,t){var n=s.createObjectURL(e),i=document.createElement("a");i.href=n,i.download=t,i.style.display="none",document.body.appendChild(i),i.click(),setTimeout(function(){document.body.removeChild(i),s.revokeObjectURL(n)},0)}function r(e){return new a.Promise(function(t,n){var i=new FileReader;i.readAsDataURL(e),i.addEventListener("loadend",function(){t(i.result.split(",")[1])}),i.addEventListener("error",n)})}Object.defineProperty(t,"__esModule",{value:!0});var o=n(5),a=n(4),s=o.global.URL||o.global.webkitURL;t.downloadBlob=i,t.blobToBase64=r},function(e,t,n){"use strict";function i(e,t){var n=document.createElement("div");return n.innerHTML=t,e.appendChild(n.firstChild)}function r(e){return l?l.getElementsByClassName(e)[0]:null}function o(e,t,n){null==n&&(n={}),d=u.defaults(n,{headerText:"",capturingText:"",progressStartText:"",progressTimerText:""}),l||(l=i(document.body,f),r("aimbrain-voice-close").addEventListener("click",function(t){e(c.CloseClicked)}),r("aimbrain-voice-record-button").addEventListener("click",function(t){e(c.RecordClicked)}),r("aimbrain-voice-stop-button").addEventListener("click",function(t){e(c.StopClicked)})),r("aimbrain-voice-token").innerHTML=t,a(!1)}function a(e){if(e===!1)r("aimbrain-voice-header-label").innerHTML=d.headerText,r("aimbrain-voice-capturing-label").innerHTML="",r("aimbrain-voice-progress-label").innerHTML=d.progressStartText;else{r("aimbrain-voice-header-label").innerHTML="",r("aimbrain-voice-capturing-label").innerHTML=d.capturingText;var t=d.progressTimerText.replace("{s}",e);r("aimbrain-voice-progress-label").innerHTML=t}r("aimbrain-voice-record-button").style.display=e===!1?"block":"none",r("aimbrain-voice-stop-button").style.display=e===!1?"none":"block"}function s(){l&&(l.parentNode.removeChild(l),l=null,d=null)}Object.defineProperty(t,"__esModule",{value:!0});var c,u=n(6);!function(e){e[e.CloseClicked=0]="CloseClicked",e[e.RecordClicked=1]="RecordClicked",e[e.StopClicked=2]="StopClicked"}(c=t.DialogEvent||(t.DialogEvent={})),n(28);var l,d,f=n(35);t.open=o,t.showProgress=a,t.close=s},function(e,t,n){var i=n(29);"string"==typeof i&&(i=[[e.id,i,""]]);n(34)(i,{});i.locals&&(e.exports=i.locals)},function(e,t,n){t=e.exports=n(30)(),t.push([e.id,".aimbrain-dialog-wrapper{position:fixed;background-color:rgba(0,0,0,.75);top:0;left:0;right:0;bottom:0;z-index:100;font-size:14px}.aimbrain-dialog-voice{top:50%;left:50%;position:absolute;transform:translate(-50%,-50%);z-index:9999;box-shadow:2px 2px 25px rgba(0,0,0,.25);box-sizing:border-box;background-color:#fff;color:#000;width:360px;height:480px;display:flex;flex-direction:column;font-family:Arial,Helvetica Neue,Helvetica,sans-serif}.aimbrain-voice-close{position:absolute;top:0;right:0;width:50px;height:50px;margin:5px;background-image:url("+n(31)+");background-size:75%;background-position:50%;background-repeat:no-repeat;cursor:pointer}.aimbrain-voice-close:active{opacity:.75}.aimbrain-voice-header-label{min-height:60px;max-width:60%;margin-top:10px}.aimbrain-voice-header-label,.aimbrain-voice-token{display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center;margin-left:auto;margin-right:auto}.aimbrain-voice-token{font-size:32px;font-weight:200;max-width:80%;flex-grow:1}.aimbrain-voice-capturing-label{text-align:center;font-size:16px;min-height:50px;display:flex;flex-direction:column;justify-content:center}.aimbrain-voice-controls{min-height:90px;position:relative;display:flex;align-items:center;padding-left:28px}.aimbrain-voice-record-button{background-image:url("+n(32)+")}.aimbrain-voice-record-button,.aimbrain-voice-stop-button{position:absolute;width:60px;height:60px;background-size:60%;background-position:50%;background-repeat:no-repeat;cursor:pointer;z-index:9999;left:50%;top:50%;transform:translate(-50%,-50%)}.aimbrain-voice-stop-button{background-image:url("+n(33)+")}.aimbrain-voice-progress-label{max-width:30%;text-align:center}.aimbrain-voice-record-button:active,aimbrain-voice-stop-button:active{opacity:.75}",""])},function(e,t){e.exports=function(){var e=[];return e.toString=function(){for(var e=[],t=0;t<this.length;t++){var n=this[t];n[2]?e.push("@media "+n[2]+"{"+n[1]+"}"):e.push(n[1])}return e.join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var i={},r=0;r<this.length;r++){var o=this[r][0];"number"==typeof o&&(i[o]=!0)}for(r=0;r<t.length;r++){var a=t[r];"number"==typeof a[0]&&i[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),e.push(a))}},e}},function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyBmaWxsPSIjMDAwMDAwIiBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICAgIDxwYXRoIGQ9Ik0xOSA2LjQxTDE3LjU5IDUgMTIgMTAuNTkgNi40MSA1IDUgNi40MSAxMC41OSAxMiA1IDE3LjU5IDYuNDEgMTkgMTIgMTMuNDEgMTcuNTkgMTkgMTkgMTcuNTkgMTMuNDEgMTJ6Ii8+CiAgICA8cGF0aCBkPSJNMCAwaDI0djI0SDB6IiBmaWxsPSJub25lIi8+Cjwvc3ZnPg==";
},function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyBmaWxsPSIjMDAwMDAwIiBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICAgIDxwYXRoIGQ9Ik0xMiAxNGMxLjY2IDAgMi45OS0xLjM0IDIuOTktM0wxNSA1YzAtMS42Ni0xLjM0LTMtMy0zUzkgMy4zNCA5IDV2NmMwIDEuNjYgMS4zNCAzIDMgM3ptNS4zLTNjMCAzLTIuNTQgNS4xLTUuMyA1LjFTNi43IDE0IDYuNyAxMUg1YzAgMy40MSAyLjcyIDYuMjMgNiA2LjcyVjIxaDJ2LTMuMjhjMy4yOC0uNDggNi0zLjMgNi02LjcyaC0xLjd6Ii8+CiAgICA8cGF0aCBkPSJNMCAwaDI0djI0SDB6IiBmaWxsPSJub25lIi8+Cjwvc3ZnPg=="},function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyBmaWxsPSIjMDAwMDAwIiBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICAgIDxwYXRoIGQ9Ik0wIDBoMjR2MjRIMHoiIGZpbGw9Im5vbmUiLz4KICAgIDxwYXRoIGQ9Ik02IDZoMTJ2MTJINnoiLz4KPC9zdmc+"},function(e,t,n){function i(e,t){for(var n=0;n<e.length;n++){var i=e[n],r=g[i.id];if(r){r.refs++;for(var o=0;o<r.parts.length;o++)r.parts[o](i.parts[o]);for(;o<i.parts.length;o++)r.parts.push(u(i.parts[o],t))}else{for(var a=[],o=0;o<i.parts.length;o++)a.push(u(i.parts[o],t));g[i.id]={id:i.id,refs:1,parts:a}}}}function r(e){for(var t=[],n={},i=0;i<e.length;i++){var r=e[i],o=r[0],a=r[1],s=r[2],c=r[3],u={css:a,media:s,sourceMap:c};n[o]?n[o].parts.push(u):t.push(n[o]={id:o,parts:[u]})}return t}function o(e,t){var n=m(),i=M[M.length-1];if("top"===e.insertAt)i?i.nextSibling?n.insertBefore(t,i.nextSibling):n.appendChild(t):n.insertBefore(t,n.firstChild),M.push(t);else{if("bottom"!==e.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");n.appendChild(t)}}function a(e){e.parentNode.removeChild(e);var t=M.indexOf(e);t>=0&&M.splice(t,1)}function s(e){var t=document.createElement("style");return t.type="text/css",o(e,t),t}function c(e){var t=document.createElement("link");return t.rel="stylesheet",o(e,t),t}function u(e,t){var n,i,r;if(t.singleton){var o=b++;n=h||(h=s(t)),i=l.bind(null,n,o,!1),r=l.bind(null,n,o,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=c(t),i=f.bind(null,n),r=function(){a(n),n.href&&URL.revokeObjectURL(n.href)}):(n=s(t),i=d.bind(null,n),r=function(){a(n)});return i(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;i(e=t)}else r()}}function l(e,t,n,i){var r=n?"":i.css;if(e.styleSheet)e.styleSheet.cssText=I(t,r);else{var o=document.createTextNode(r),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(o,a[t]):e.appendChild(o)}}function d(e,t){var n=t.css,i=t.media;if(i&&e.setAttribute("media",i),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}function f(e,t){var n=t.css,i=t.sourceMap;i&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(i))))+" */");var r=new Blob([n],{type:"text/css"}),o=e.href;e.href=URL.createObjectURL(r),o&&URL.revokeObjectURL(o)}var g={},v=function(e){var t;return function(){return"undefined"==typeof t&&(t=e.apply(this,arguments)),t}},p=v(function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())}),m=v(function(){return document.head||document.getElementsByTagName("head")[0]}),h=null,b=0,M=[];e.exports=function(e,t){t=t||{},"undefined"==typeof t.singleton&&(t.singleton=p()),"undefined"==typeof t.insertAt&&(t.insertAt="bottom");var n=r(e);return i(n,t),function(e){for(var o=[],a=0;a<n.length;a++){var s=n[a],c=g[s.id];c.refs--,o.push(c)}if(e){var u=r(e);i(u,t)}for(var a=0;a<o.length;a++){var c=o[a];if(0===c.refs){for(var l=0;l<c.parts.length;l++)c.parts[l]();delete g[c.id]}}}};var I=function(){var e=[];return function(t,n){return e[t]=n,e.filter(Boolean).join("\n")}}()},function(e,t){e.exports="<div class=aimbrain-dialog-wrapper> <div class=aimbrain-dialog-voice> <div class=aimbrain-voice-close></div> <div class=aimbrain-voice-header-label></div> <div class=aimbrain-voice-token></div> <div class=aimbrain-voice-capturing-label></div> <div class=aimbrain-voice-controls> <div class=aimbrain-voice-progress-label></div> <div class=aimbrain-voice-record-button></div> <div class=aimbrain-voice-stop-button></div> </div> </div> </div> "},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,r=n(37),o=n(38),a=n(39);!function(e){function t(e){switch(e){case u.Video:return o.isVideoSupported();case u.Images:return o.isImagingSupported();default:return!1}}function n(e,t,n){return r.enrollWithData(e,t,n)}function i(e,t,n){return r.authenticateWithData(e,t,n)}function s(e){return a.recordFace(e,!1)}function c(e,t){return void 0===t&&(t=1),a.recordFace(e,!0,t)}var u;!function(e){e[e.Video=0]="Video",e[e.Images=1]="Images"}(u=e.RecordingMode||(e.RecordingMode={})),e.isSupported=t,e.enrollWithData=n,e.authenticateWithData=i;var l;!function(e){e[e.PopupClosed=0]="PopupClosed",e[e.NotSupported=-1]="NotSupported",e[e.NoDevice=-2]="NoDevice",e[e.UnexpectedError=-3]="UnexpectedError"}(l=e.RecordingError||(e.RecordingError={})),e.recordFaceVideo=s,e.recordFaceImages=c}(i=t.facial||(t.facial={}))},function(e,t,n){"use strict";function i(e,t,n){var i=s.getCachedSession();return null==i?o.Promise.reject({errorCode:a.api.ErrorCode.NoOpenSession,error:"This call requires active session"}):n?o.Promise.resolve(a.api.enrollFace(i.getId(),e,t).serialize()):a.api.enrollFace(i.getId(),e,t).send()}function r(e,t,n){var i=s.getCachedSession();return null==i?o.Promise.reject({errorCode:a.api.ErrorCode.NoOpenSession,error:"This call requires active session"}):n?o.Promise.resolve(a.api.authenticateFace(i.getId(),e,t).serialize()):a.api.authenticateFace(i.getId(),e,t).send().then(function(e){return s.setCachedSessionScore(e.score),e})}Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),a=n(1),s=n(12);t.enrollWithData=i,t.authenticateWithData=r},function(e,t,n){"use strict";function i(){return g}function r(){return f}function o(e,t,n){function i(){if(0==r.length)n();else{var e={video:r.pop(),audio:!1};d.call(navigator,e,function(e){t(e)},function(e){i()})}}var r=e.slice(0);i()}function a(e,t,n){return new Promise(function(i,r){p=t,m=n,o(e?S:x,function(e){h=e,"object"==typeof p.srcObject?p.srcObject=e:p.src=URL.createObjectURL(e),f&&(m.setAttribute("width",I.toString()),m.setAttribute("height",y.toString())),i()},function(){r(new Error("Failed to initialize video"))})})}function s(e){return new Promise(function(t,n){var i=[],r=new MediaRecorder(h,v),o=[];w=0,r.ondataavailable=function(n){if(0===w&&(w=Date.now()),w+e<=Date.now()){try{l()}catch(e){}M.blobToBase64(new Blob(i,{type:"video/webm"})).then(function(e){o[0]=e,t(o)})}else n.data.size>0&&i.push(n.data)},r.start(500)})}function c(e){return new Promise(function(t,n){if(e.toBlob)m.toBlob(function(e){M.blobToBase64(e).then(function(e){t(e)}).catch(n)},"image/jpeg",.95);else{var i=e.toDataURL("image/jpeg"),r=i.substr(i.indexOf(",")+1);t(r)}})}function u(e,t){return new Promise(function(n,i){var r=0,o=[];C=setInterval(function(){function e(){clearInterval(C),C=0,l(),n(o)}if(r>=t)e();else try{var a=p.videoWidth,s=p.videoHeight,u=I/y,d=(a-s*u)/2,f=0,g=s*u,v=m.getContext("2d");v.drawImage(p,d,f,g,s,0,0,I,y),c(m).then(function(n){o.push(n),r++,r>=t&&e()}).catch(function(e){l(),i(e)})}catch(e){l(),i(e)}},e/t)})}function l(){try{clearInterval(C),C=0,h.getTracks().forEach(function(e){e.stop()}),h=null,p=null,m=null}catch(e){}}Object.defineProperty(t,"__esModule",{value:!0});var d,f,g,v,p,m,h,b=n(5),M=n(26),I=240,y=320,S=[!0,{facingMode:"user",width:{exact:640},height:{exact:360}},{facingMode:"user",width:{exact:352},height:{exact:288}},{facingMode:"user",width:{exact:320},height:{exact:320}}],x=[!0,{facingMode:"user",width:640,height:480}],w=0,C=0;navigator.getUserMedia?(d=navigator.getUserMedia,f=!0):navigator.mozGetUserMedia?(d=navigator.mozGetUserMedia,f=!0):f=!1,b.global.MediaRecorder?MediaRecorder.isTypeSupported("video/webm;codecs=vp9")?(v={mimeType:"video/webm; codecs=vp9"},g=!0):MediaRecorder.isTypeSupported("video/webm;codecs=vp8")?(v={mimeType:"video/webm; codecs=vp8"},g=!0):g=!1:g=!1,t.isVideoSupported=i,t.isImagingSupported=r,t.initVideo=a,t.captureVideo=s,t.captureImages=u,t.stopRecording=l},function(e,t,n){"use strict";function i(e,n,i){void 0===i&&(i=t.defaultImages);var l=!n;return l&&!u.isVideoSupported()?Promise.reject(c.facial.RecordingError.NotSupported):n&&!u.isImagingSupported()?Promise.reject(c.facial.RecordingError.NotSupported):new Promise(function(d,f){s.open(function(e){switch(e){case s.DialogEvent.CloseClicked:a(),f(c.facial.RecordingError.PopupClosed);break;case s.DialogEvent.RecordClicked:if(l&&u.isVideoSupported())r(t.defaultDuration),u.captureVideo(t.defaultDuration).then(function(e){o(),s.close(),d(e)},function(e){o(),s.close(),f(c.facial.RecordingError.UnexpectedError)});else if(n&&u.isImagingSupported()){var g=Math.min(1e3*i,t.defaultDuration);r(g),u.captureImages(g,i).then(function(e){o(),s.close(),d(e)},function(e){o(),s.close(),f(c.facial.RecordingError.UnexpectedError)})}else s.close(),f(c.facial.RecordingError.NotSupported);break;case s.DialogEvent.StopClicked:a(),f(c.facial.RecordingError.PopupClosed)}},e),u.initVideo(l,s.getVideoElement(),s.getCanvasElement()).then(function(){s.setStatus(s.DialogStatus.Ready)}).catch(function(e){s.close(),f(c.facial.RecordingError.NoDevice)})})}function r(e){s.setStatus(s.DialogStatus.Progress,Math.round(e/1e3).toString()),d=Date.now(),l=setInterval(function(){var t=Date.now();if(0!==d&&d+e>=t){var n=Math.round((e-(t-d))/1e3);s.setStatus(s.DialogStatus.Progress,n.toString())}d+e<t&&l&&(clearInterval(l),s.setStatus(s.DialogStatus.Progress,"0"))},1e3)}function o(){l&&(clearInterval(l),l=null)}function a(){u.stopRecording(),o(),s.close()}Object.defineProperty(t,"__esModule",{value:!0});var s=n(40),c=n(36),u=n(38);t.defaultDuration=3e3,t.defaultImages=3;var l,d=0;t.recordFace=i,t.cancelRecording=a},function(e,t,n){"use strict";function i(e,t){var n=document.createElement("div");return n.innerHTML=t,e.appendChild(n.firstChild)}function r(e){return g?g.getElementsByClassName(e)[0]:null}function o(e,t){null==t&&(t={}),p=d.defaults(t,{headerText:"",hintText:"",capturingText:"",progressTimerText:""}),g||(g=i(document.body,m),r("aimbrain-face-close").addEventListener("click",function(t){e(f.CloseClicked)}),r("aimbrain-face-record-button").addEventListener("click",function(t){v&&e(f.RecordClicked)}),r("aimbrain-face-stop-button").addEventListener("click",function(t){e(f.StopClicked)})),v=!1,a(l.Initialising)}function a(e,t){if(g)switch(e){case l.Initialising:v=!1,r("aimbrain-face-record-button").style.display="none",r("aimbrain-face-stop-button").style.display="none",r("aimbrain-face-header-label").innerHTML=p.headerText,r("aimbrain-face-hint-label").innerHTML=p.hintText;break;case l.Ready:v=!0,r("aimbrain-face-record-button").style.display="block",r("aimbrain-face-stop-button").style.display="none",r("aimbrain-face-header-label").innerHTML=p.headerText,r("aimbrain-face-hint-label").innerHTML=p.hintText;break;case l.Progress:v=!0,r("aimbrain-face-header-label").innerHTML="",r("aimbrain-face-hint-label").innerHTML=p.capturingText;var n=p.progressTimerText.replace("{s}",t);r("aimbrain-face-progress-label").innerHTML=n,r("aimbrain-face-record-button").style.display="none",r("aimbrain-face-stop-button").style.display="block"}}function s(){return g?r("aimbrain-face-video"):null}function c(){return g?r("aimbrain-face-canvas"):null}function u(){g&&(g.parentNode.removeChild(g),g=null,p=null)}Object.defineProperty(t,"__esModule",{value:!0});var l,d=n(6);!function(e){e[e.Initialising=0]="Initialising",e[e.Ready=1]="Ready",e[e.Progress=2]="Progress"}(l=t.DialogStatus||(t.DialogStatus={}));var f;!function(e){e[e.CloseClicked=0]="CloseClicked",e[e.RecordClicked=1]="RecordClicked",e[e.StopClicked=2]="StopClicked"}(f=t.DialogEvent||(t.DialogEvent={})),n(41);var g,v,p,m=n(47);t.open=o,t.setStatus=a,t.getVideoElement=s,t.getCanvasElement=c,t.close=u},function(e,t,n){var i=n(42);"string"==typeof i&&(i=[[e.id,i,""]]);n(34)(i,{});i.locals&&(e.exports=i.locals)},function(e,t,n){t=e.exports=n(30)(),t.push([e.id,".aimbrain-dialog-wrapper{position:fixed;background-color:rgba(0,0,0,.75);top:0;left:0;right:0;bottom:0;z-index:100;font-size:14px}.aimbrain-dialog-face{top:50%;left:50%;position:absolute;transform:translate(-50%,-50%);z-index:9999;box-shadow:2px 2px 25px rgba(0,0,0,.25);box-sizing:border-box;color:#fff;background-color:#000;width:360px;height:480px;display:flex;flex-direction:column;font-family:Arial,Helvetica Neue,Helvetica,sans-serif}.aimbrain-face-close{position:absolute;top:0;right:0;width:50px;height:50px;margin:5px;background-image:url("+n(43)+");background-size:75%;background-position:50%;background-repeat:no-repeat;cursor:pointer}.aimbrain-face-close:active{opacity:.75}.aimbrain-face-video-wrapper{position:absolute;left:0;right:0;top:0;bottom:0;overflow:hidden;padding:0;margin:0}.aimbrain-face-video{height:480px;margin:0;position:relative;left:50%;transform:translate(-50%)}.aimbrain-face-viewfinder{left:0;right:0;top:0;bottom:0;overflow:hidden;padding:0;margin:0;background-image:url("+n(44)+");position:absolute;background-size:100% 100%}.aimbrain-face-header-label{display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center;min-height:70px;max-width:60%;margin-left:auto;margin-right:auto;z-index:10}.aimbrain-face-filler{flex-grow:1;display:flex}.aimbrain-face-hint-label{text-align:center;font-size:16px;display:flex;flex-direction:column;justify-content:center;z-index:10}.aimbrain-face-controls{min-height:70px;position:relative;display:flex;align-items:center;padding-left:28px;z-index:10}.aimbrain-face-record-button{background-image:url("+n(45)+");background-size:50%}.aimbrain-face-record-button,.aimbrain-face-stop-button{position:absolute;width:60px;height:60px;background-position:50%;background-repeat:no-repeat;cursor:pointer;z-index:9999;left:50%;top:50%;transform:translate(-50%,-50%)}.aimbrain-face-stop-button{background-image:url("+n(46)+");background-size:60%}.aimbrain-face-progress-label{max-width:30%;text-align:center}.aimbrain-face-record-button:active,.aimbrain-face-stop-button:active{opacity:.75}.aimbrain-face-canvas{display:block;width:240px;height:320px;z-index:-1;position:absolute;top:0;left:0}",""])},function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyBmaWxsPSIjRkZGRkZGIiBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICAgIDxwYXRoIGQ9Ik0xOSA2LjQxTDE3LjU5IDUgMTIgMTAuNTkgNi40MSA1IDUgNi40MSAxMC41OSAxMiA1IDE3LjU5IDYuNDEgMTkgMTIgMTMuNDEgMTcuNTkgMTkgMTkgMTcuNTkgMTMuNDEgMTJ6Ii8+CiAgICA8cGF0aCBkPSJNMCAwaDI0djI0SDB6IiBmaWxsPSJub25lIi8+Cjwvc3ZnPg=="},function(e,t){e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjxzdmcKICAgeG1sbnM6c3ZnPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIKICAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB2aWV3Qm94PSIwIDAgOTM3LjUgMTI1MCIKICAgZmlsbD0iIzAwMDAwMCIKICAgb3BhY2l0eT0iMC42IgogICBoZWlnaHQ9IjEyNTAiCiAgIHdpZHRoPSI5MzcuNSIKICAgdmVyc2lvbj0iMS4xIj4KICA8cGF0aAogICAgIGQ9Ik0gMCw2MjUgMCwwIDQ2OC43NSwwIDkzNy41LDAgbCAwLDYyNSAwLDYyNSAtNDY4Ljc1LDAgTCAwLDEyNTAgMCw2MjUgWiBtIDQ4OC40Mzc1LDQyNC45ODMgYyAzNy40NDc2MywtMi40ODczIDczLjA1MDA3LC0xMS45NTA2IDEwNi4wMDEyOSwtMjguMTc1OCAxNC40OTczOCwtNy4xMzg0IDE5LjI2ODMyLC05Ljg4NzMgMzMuMDYxMjEsLTE5LjA0ODYgNTkuMjkwMTIsLTM5LjM4MTE2IDEwMS43NDUyNSwtOTkuNzk0ODUgMTE4LjQxOTY5LC0xNjguNTExMTYgNC40NTc3NSwtMTguMzcwNzUgNi43MDQ1NiwtMzMuNjEyODggNy44MTIxOCwtNTIuOTk3NDQgMC44MzQ2OSwtMTQuNjA3NTYgMC44NDUwNywtMzEyLjE1NTE1IDAuMDExMywtMzI2LjUxMzg4IC0xLjE3MjI1LC0yMC4xOTAwMyAtMy41MjAxMiwtMzUuODk2MjMgLTguMTc3MjUsLTU0LjcwMjQ2IEMgNzI1LjU1MzU2LDMxOS4yMTk2MSA2NjguNzc5MTksMjQ5LjU3NjczIDU5My40Mzc1LDIxMy40MjM1MiA1NTguNzg2ODcsMTk2Ljc5NjE5IDUyMy44MzkyMywxODcuODQ2MzcgNDg1LDE4NS42NTM1NCBjIC03Mi4yMTkwMywtNC4wNzc0NSAtMTMyLjIxNzksMTEuNTMwMiAtMTg3LjUsNDguNzc0ODMgLTYzLjIyOTQsNDIuNTk4ODcgLTEwNy44MDk2LDExMS42NjU5NiAtMTIwLjI4NjMsMTg2LjM1Njg0IC0zLjk2MTUsMjMuNzE1MjQgLTMuNjc1MTYsOS44MDY4OCAtMy45Mjc2LDE5MC43NzcyOSAtMC4yMzM5NywxNjcuNzMxNzUgLTAuMTcwMDksMTczLjU5NDE5IDIuMDgzOTksMTkxLjI1IDEwLjM3MTUyLDgxLjIzODI1IDU1LjgxMTA4LDE1NC4zMzE2OSAxMjQuNDY3MDQsMjAwLjIxNTkgNDAuNjE3NDQsMjcuMTQ1NSA4OC40NjM3Nyw0My40NTA0IDEzNy42NjI4Nyw0Ni45MTI0IDEwLjQ5MjQ0LDAuNzM4MyA0MC4wODgxOSwwLjc2MjggNTAuOTM3NSwwLjA0MyB6IiAvPgo8L3N2Zz4K"},function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyBmaWxsPSIjRkZGRkZGIiBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICAgIDxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMuMiIvPgogICAgPHBhdGggZD0iTTkgMkw3LjE3IDRINGMtMS4xIDAtMiAuOS0yIDJ2MTJjMCAxLjEuOSAyIDIgMmgxNmMxLjEgMCAyLS45IDItMlY2YzAtMS4xLS45LTItMi0yaC0zLjE3TDE1IDJIOXptMyAxNWMtMi43NiAwLTUtMi4yNC01LTVzMi4yNC01IDUtNSA1IDIuMjQgNSA1LTIuMjQgNS01IDV6Ii8+CiAgICA8cGF0aCBkPSJNMCAwaDI0djI0SDB6IiBmaWxsPSJub25lIi8+Cjwvc3ZnPg=="},function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyBmaWxsPSIjRkZGRkZGIiBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICAgIDxwYXRoIGQ9Ik0wIDBoMjR2MjRIMHoiIGZpbGw9Im5vbmUiLz4KICAgIDxwYXRoIGQ9Ik02IDZoMTJ2MTJINnoiLz4KPC9zdmc+"},function(e,t){e.exports="<div class=aimbrain-dialog-wrapper> <div class=aimbrain-dialog-face> <div class=aimbrain-face-video-wrapper> <video autoplay class=aimbrain-face-video></video> </div> <div class=aimbrain-face-viewfinder></div> <canvas width=360 height=480 class=aimbrain-face-canvas></canvas> <div class=aimbrain-face-close></div> <div class=aimbrain-face-header-label></div> <div class=aimbrain-face-filler></div> <div class=aimbrain-face-hint-label></div> <div class=aimbrain-face-controls> <div class=aimbrain-face-progress-label></div> <div class=aimbrain-face-record-button></div> <div class=aimbrain-face-stop-button></div> </div> </div> </div>"}])});